<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8">

<title>LibXML</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
  var index_rel_prefix = "./";
</script>

<script src="./js/navigation.js" defer></script>
<script src="./js/search.js" defer></script>
<script src="./js/search_index.js" defer></script>
<script src="./js/searcher.js" defer></script>
<script src="./js/darkfish.js" defer></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>


    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search (/) for a class, method, ..." spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  <div id="project-metadata">
    
<div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
    <li><a href="./HISTORY.html">HISTORY</a>
    <li><a href="./LICENSE.html">LICENSE</a>
    <li><a href="./README_rdoc.html">README</a>
  </ul>
</div>

    <div id="classindex-section" class="nav-section">
  <h3>Class and Module Index</h3>

  <ul class="link-list">
  <li><code><a href="./Float.html">Float</a></code>
  <li><details><summary><code><a href="./LibXML.html">LibXML</a></code></summary>
  <ul class="link-list">
  <li><details><summary><code><a href="./LibXML/XML.html">XML</a></code></summary>
  <ul class="link-list">
  <li><code><a href="./LibXML/XML/Attr.html">Attr</a></code>
  <li><code><a href="./LibXML/XML/AttrDecl.html">AttrDecl</a></code>
  <li><code><a href="./LibXML/XML/Attributes.html">Attributes</a></code>
  <li><code><a href="./LibXML/XML/Document.html">Document</a></code>
  <li><code><a href="./LibXML/XML/Dtd.html">Dtd</a></code>
  <li><code><a href="./LibXML/XML/Encoding.html">Encoding</a></code>
  <li><code><a href="./LibXML/XML/Error.html">Error</a></code>
  <li><details><summary><code><a href="./LibXML/XML/HTMLParser.html">HTMLParser</a></code></summary>
  <ul class="link-list">
  <li><code><a href="./LibXML/XML/HTMLParser/Context.html">Context</a></code>
  <li><code><a href="./LibXML/XML/HTMLParser/Options.html">Options</a></code>
  </ul></details>
  <li><code><a href="./LibXML/XML/InputCallbacks.html">InputCallbacks</a></code>
  <li><code><a href="./LibXML/XML/Namespace.html">Namespace</a></code>
  <li><code><a href="./LibXML/XML/Namespaces.html">Namespaces</a></code>
  <li><code><a href="./LibXML/XML/Node.html">Node</a></code>
  <li><details><summary><code><a href="./LibXML/XML/Parser.html">Parser</a></code></summary>
  <ul class="link-list">
  <li><code><a href="./LibXML/XML/Parser/Context.html">Context</a></code>
  <li><code><a href="./LibXML/XML/Parser/Options.html">Options</a></code>
  </ul></details>
  <li><code><a href="./LibXML/XML/Reader.html">Reader</a></code>
  <li><code><a href="./LibXML/XML/RelaxNG.html">RelaxNG</a></code>
  <li><details><summary><code><a href="./LibXML/XML/SaxParser.html">SaxParser</a></code></summary>
  <ul class="link-list">
  <li><code><a href="./LibXML/XML/SaxParser/Callbacks.html">Callbacks</a></code>
  <li><code><a href="./LibXML/XML/SaxParser/VerboseCallbacks.html">VerboseCallbacks</a></code>
  </ul></details>
  <li><details><summary><code><a href="./LibXML/XML/Schema.html">Schema</a></code></summary>
  <ul class="link-list">
  <li><code><a href="./LibXML/XML/Schema/Attribute.html">Attribute</a></code>
  <li><code><a href="./LibXML/XML/Schema/Element.html">Element</a></code>
  <li><code><a href="./LibXML/XML/Schema/Facet.html">Facet</a></code>
  <li><code><a href="./LibXML/XML/Schema/Type.html">Type</a></code>
  <li><code><a href="./LibXML/XML/Schema/Types.html">Types</a></code>
  </ul></details>
  <li><code><a href="./LibXML/XML/Writer.html">Writer</a></code>
  <li><code><a href="./LibXML/XML/XInclude.html">XInclude</a></code>
  <li><details><summary><code><a href="./LibXML/XML/XPath.html">XPath</a></code></summary>
  <ul class="link-list">
  <li><code><a href="./LibXML/XML/XPath/Context.html">Context</a></code>
  <li><code><a href="./LibXML/XML/XPath/Expression.html">Expression</a></code>
  <li><code><a href="./LibXML/XML/XPath/Object.html">Object</a></code>
  </ul></details>
  </ul></details>
  </ul></details>
  <li><code><a href="./Object.html">Object</a></code>
</div>

  </div>
</nav>

<main role="main">


<h1 id="label-LibXML+Ruby"><a href="LibXML.html"><code>LibXML</code></a> Ruby<span><a href="#label-LibXML+Ruby">&para;</a> <a href="#top">&uarr;</a></span></h1>

<h2 id="label-Overview">Overview<span><a href="#label-Overview">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The libxml gem provides Ruby language bindings for GNOME’s Libxml2 XML toolkit. It is free software, released under the MIT License.</p>

<p>We think libxml-ruby is the best XML library for Ruby because:</p>
<ul><li>
<p>Speed - Its much faster than REXML and Hpricot</p>
</li><li>
<p>Features - It provides an amazing number of featues</p>
</li><li>
<p>Conformance - It passes all 1800+ tests from the OASIS XML Tests Suite</p>
</li></ul>

<h2 id="label-Requirements">Requirements<span><a href="#label-Requirements">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>libxml-ruby requires Ruby 3.0.0 or higher.  It depends on libxml2 to function properly.  libxml2, in turn, depends on:</p>
<ul><li>
<p>libm      (math routines: very standard)</p>
</li><li>
<p>libz      (zlib)</p>
</li><li>
<p>libiconv</p>
</li></ul>

<p>If you are running Linux or Unix you’ll need a C compiler so the extension can be compiled when it is installed.  If you are running Windows, then install the x64-mingw-ucr gem or build it yourself using (Ruby for <a href="https://rubyinstaller.org/">Windows)</a> or directly with <a href="https://msys2.github.io/">msys2</a> and ucrt64.</p>

<h2 id="label-Installation">Installation<span><a href="#label-Installation">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The easiest way to install libxml-ruby is via RubyGems.  To install:</p>

<p><code>gem install libxml-ruby</code></p>

<p>If the extension compile process cannot find libxml2, you may need to indicate the location of the libxml2 configuration utility as it is used to find the required header and include files.  (If you need to indicate a location for the libxml2 library or header files different than reported by <code>xml2-config</code>, see the additional configuration options.)</p>

<p>This may be done with RubyGems:</p>

<p><code>gem install libxml-ruby -- --with-xml2-dir=/path/to/xml2-config</code></p>

<p>Or bundler:</p>

<p><code>bundle config build.libxml-ruby --with-xml2-config=/path/to/xml2-config</code></p>

<p><code>bundle install libxml-ruby</code></p>

<p>If you are running Windows, then install the libxml-ruby-x64-mingw32 gem. The gem includes prebuilt extensions for Ruby 3.2 and 3.3.</p>

<p>The gem also includes a Microsoft VC++ solution and XCode project - these are very useful for debugging.</p>

<p>libxml-ruby’s source codes lives on <a href="https://github.com/xml4r/libxml-ruby">GitHub</a>.</p>

<h2 id="label-Getting+Started">Getting Started<span><a href="#label-Getting+Started">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Using libxml is easy. First decide what parser you want to use:</p>
<ul><li>
<p>Generally you’ll want to use the <a href="LibXML/XML/Parser.html"><code>LibXML::XML::Parser</code></a> which provides a tree based API.</p>
</li><li>
<p>For larger documents that don’t fit into memory, or if you prefer an input based API, use the <a href="LibXML/XML/Reader.html"><code>LibXML::XML::Reader</code></a>.</p>
</li><li>
<p>To parse HTML files use <a href="LibXML/XML/HTMLParser.html"><code>LibXML::XML::HTMLParser</code></a>.</p>
</li><li>
<p>If you are masochistic, then use the <a href="LibXML/XML/SaxParser.html"><code>LibXML::XML::SaxParser</code></a>, which provides a callback API.</p>
</li></ul>

<p>Once you have chosen a parser, choose a datasource.  Libxml can parse files, strings, URIs and IO streams.  For each data source you can specify an <a href="LibXML/XML/Encoding.html"><code>LibXML::XML::Encoding</code></a>, a base uri and various parser options.  For more information, refer the <a href="LibXML/XML/Parser.html#method-c-document"><code>LibXML::XML::Parser.document</code></a>, <a href="LibXML/XML/Parser.html#method-c-file"><code>LibXML::XML::Parser.file</code></a>, <a href="LibXML/XML/Parser.html#method-c-io"><code>LibXML::XML::Parser.io</code></a> or LibXML:::XML::Parser.string methods (the same methods are defined on all four parser classes).</p>

<h2 id="label-Advanced+Functionality">Advanced Functionality<span><a href="#label-Advanced+Functionality">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Beyond the basics of parsing and processing XML and HTML documents, libxml provides a wealth of additional functionality.</p>

<p>Most commonly, you’ll want to use its <a href="LibXML/XML/XPath.html"><code>LibXML::XML::XPath</code></a> support, which makes it easy to find data inside an XML document.  Although not as popular, LibXML::XML::XPointer provides another API for finding data inside an XML document.</p>

<p>Often times you’ll need to validate data before processing it. For example, if you accept user generated content submitted over the Web, you’ll want to verify that it does not contain malicious code such as embedded scripts. This can be done using libxml’s powerful set of validators:</p>
<ul><li>
<p>DTDs (<a href="LibXML/XML/Dtd.html"><code>LibXML::XML::Dtd</code></a>)</p>
</li><li>
<p>Relax Schemas (<a href="LibXML/XML/RelaxNG.html"><code>LibXML::XML::RelaxNG</code></a>)</p>
</li><li>
<p>XML Schema (<a href="LibXML/XML/Schema.html"><code>LibXML::XML::Schema</code></a>)</p>
</li></ul>

<p>Finally, if you’d like to use XSL Transformations to process data, then install the <a href="https://github.com/xml4r/libxslt-rubygem">libxslt gem</a>.</p>

<h2 id="label-Usage">Usage<span><a href="#label-Usage">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>For information about using libxml-ruby please refer to its <a href="http://xml4r.github.io/libxml-ruby">documentation</a>. Some tutorials are also <a href="https://github.com/xml4r/libxml-ruby/wiki">available</a>.</p>

<p>All libxml classes are in the <a href="LibXML/XML.html"><code>LibXML::XML</code></a> module. The easiest way to use libxml is to <code>require &#39;xml&#39;</code>.  This will mixin the <a href="LibXML.html"><code>LibXML</code></a> module into the global namespace, allowing you to write code like this:</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;xml&#39;</span>
<span class="ruby-identifier">document</span> = <span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Document</span>.<span class="ruby-identifier">new</span>
</pre>

<p>However, when creating an application or library you plan to redistribute, it is best to not add the <a href="LibXML.html"><code>LibXML</code></a> module to the global namespace, in which case you can either write your code like this:</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;libxml&#39;</span>
<span class="ruby-identifier">document</span> = <span class="ruby-constant">LibXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Document</span>.<span class="ruby-identifier">new</span>
</pre>

<p>Or you can utilize a namespace for your own work and include <a href="LibXML.html"><code>LibXML</code></a> into it. For example:</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;libxml&#39;</span>

<span class="ruby-keyword">module</span> <span class="ruby-constant">MyApplication</span>
  <span class="ruby-identifier">include</span> <span class="ruby-constant">LibXML</span>

  <span class="ruby-keyword">class</span> <span class="ruby-constant">MyClass</span>
    <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">some_method</span>
      <span class="ruby-identifier">document</span> = <span class="ruby-constant">XML</span><span class="ruby-operator">::</span><span class="ruby-constant">Document</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>For simplicity’s sake, the documentation uses the xml module in its examples.</p>

<h2 id="label-Tests">Tests<span><a href="#label-Tests">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>To run tests you first need to build the shared libary:</p>

<pre class="ruby"><span class="ruby-identifier">rake</span> <span class="ruby-identifier">compile</span>
</pre>

<p>Once you have build the shared libary, you can then run tests using rake:</p>

<pre class="ruby"><span class="ruby-identifier">rake</span> <span class="ruby-identifier">test</span>
</pre>

<p>+Build status: <a href="https://github.com/xml4r/libxml-ruby/actions/workflows/mri.yml"><img src="https://github.com/xml4r/libxml-ruby/actions/workflows/mri.yml/badge.svg"></a></p>

<h2 id="label-Performance">Performance<span><a href="#label-Performance">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>In addition to being feature rich and conformation, the main reason people use libxml-ruby is for performance.  Here are the results of a couple simple benchmarks recently blogged about on the Web (you can find them in the benchmark directory of the libxml distribution).</p>

<p>From <a href="http://depixelate.com/2008/4/23/ruby-xml-parsing-benchmarks">depixelate.com/2008/4/23/ruby-xml-parsing-benchmarks</a></p>

<pre>              user     system      total        real
libxml    0.032000   0.000000   0.032000 (  0.031000)
Hpricot   0.640000   0.031000   0.671000 (  0.890000)
REXML     1.813000   0.047000   1.860000 (  2.031000)</pre>

<p>From <a href="https://svn.concord.org/svn/projects/trunk/common/ruby/xml_benchmarks">svn.concord.org/svn/projects/trunk/common/ruby/xml_benchmarks</a>/</p>

<pre>              user     system      total        real
libxml    0.641000   0.031000   0.672000 (  0.672000)
hpricot   5.359000   0.062000   5.421000 (  5.516000)
rexml    22.859000   0.047000  22.906000 ( 23.203000)</pre>

<h2 id="label-Documentation">Documentation<span><a href="#label-Documentation">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Documentation is available via rdoc, and is installed automatically with the gem.</p>

<p>libxml-ruby’s <a href="https://xml4r.github.io/libxml-ruby/rdoc/index.html">online documentation</a> is generated using Hanna, which is a development gem dependency.</p>

<p>Note that older versions of Rdoc, which ship with Ruby 1.8.x, will report a number of errors.  To avoid them, install Rdoc 2.1 or higher.  Once you have installed the gem, you’ll have to disable the version of Rdoc that Ruby 1.8.x includes.  An easy way to do that is rename the directory <code>ruby/lib/ruby/1.8/rdoc</code> to <code>ruby/lib/ruby/1.8/rdoc_old</code>.</p>

<h2 id="label-Support">Support<span><a href="#label-Support">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>If you have any questions about using libxml-ruby, please report an issue on <a href="https://github.com/xml4r/libxml-ruby/issues">GitHub</a>.</p>

<h2 id="label-Memory+Management">Memory Management<span><a href="#label-Memory+Management">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>libxml-ruby automatically manages memory associated with the underlying libxml2 library.  The bindings create a one-to-one mapping between Ruby objects and libxml documents and libxml parent nodes (ie, nodes that do not have a parent and do not belong to a document).  In these cases, the bindings manage the memory.  They do this by installing a free function and storing a back pointer to the Ruby object from the xmlnode using the _private member on libxml structures.  When the Ruby object goes out of scope, the underlying libxml structure is freed.  Libxml itself then frees all child nodes (recursively).</p>

<p>For all other nodes (the vast majority), the bindings create temporary Ruby objects that get freed once they go out of scope. Thus there can be more than one Ruby object pointing to the same xml node. To mostly hide this from a programmer on the Ruby side, the <code>#eql?</code> and <code>#==</code> methods are overriden to check if two Ruby objects wrap the same xmlnode.  If they do, then the methods return true.  During the mark phase, each of these temporary objects marks its owning document, thereby keeping the Ruby document object alive and thus the xmldoc tree.</p>

<p>In the sweep phase of the garbage collector, or when a program ends, there is no order to how Ruby objects are freed.  In fact, the Ruby document object is almost always freed before any Ruby objects that wrap child nodes. However, this is ok because those Ruby objects do not have a free function and are no longer in scope (since if they were the document would not be freed).</p>

<h2 id="label-License">License<span><a href="#label-License">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>See <a href="LICENSE.html">LICENSE</a> for license information.</p>

</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.6.2.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

